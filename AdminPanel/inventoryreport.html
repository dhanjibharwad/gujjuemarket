<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    .container { max-width: 1400px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; }
    h1 { margin-bottom: 30px; color: #1d1d1f; font-size: 24px; }
    .controls { display: flex; gap: 15px; margin-bottom: 30px; align-items: center; flex-wrap: wrap; }
    select { padding: 10px 14px; border: 1px solid #d2d2d7; border-radius: 8px; font-size: 14px; background: white; outline: none; cursor: pointer; }
    .download-btns { display: flex; gap: 10px; }
    button { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.2s; }
    .btn-excel { background: #217346; color: white; }
    .btn-pdf { background: #d32f2f; color: white; }
    button:hover { opacity: 0.9; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #f5f5f7; }
    th { background: #fafafa; font-weight: 600; color: #86868b; font-size: 12px; text-transform: uppercase; }
    tr:hover { background: #fafafa; }
</style>
<div class="container">
    <h1>Inventory Report</h1>
    <div class="controls">
        <label>Select days for report:</label>
        <select id="daysSelect">
            <option value="7">7 days</option>
            <option value="10">10 days</option>
            <option value="15">15 days</option>
            <option value="30">1 month</option>
            <option value="90">3 months</option>
            <option value="180">6 months</option>
            <option value="365">12 months</option>
        </select>
        <div class="download-btns">
            <button class="btn-excel" onclick="downloadExcel()">Download Excel</button>
            <button class="btn-pdf" onclick="downloadPDF()">Download PDF</button>
        </div>
    </div>
    <table id="inventoryTable">
        <thead>
            <tr>
                <th>SKU</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Business Price</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr>
                <td>SKU001</td>
                <td>$25.00</td>
                <td>150</td>
                <td>$22.50</td>
            </tr>
            <tr>
                <td>SKU002</td>
                <td>$45.00</td>
                <td>85</td>
                <td>$40.50</td>
            </tr>
            <tr>
                <td>SKU003</td>
                <td>$15.00</td>
                <td>200</td>
                <td>$13.50</td>
            </tr>
        </tbody>
    </table>
</div>

<script>
    function getTableData() {
        const rows = document.querySelectorAll('#inventoryTable tbody tr');
        const data = [];
        rows.forEach(row => {
            const cells = row.querySelectorAll('td');
            data.push({
                sku: cells[0].textContent,
                price: cells[1].textContent,
                quantity: cells[2].textContent,
                businessPrice: cells[3].textContent
            });
        });
        return data;
    }

    function downloadExcel() {
        const data = getTableData();
        const ws = XLSX.utils.json_to_sheet(data.map(item => ({
            'SKU': item.sku,
            'Price': item.price,
            'Quantity': item.quantity,
            'Business Price': item.businessPrice
        })));
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Inventory Report');
        const days = document.getElementById('daysSelect').value;
        XLSX.writeFile(wb, `inventory_report_${days}days.xlsx`);
    }

    function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const days = document.getElementById('daysSelect').value;
        
        doc.setFontSize(18);
        doc.text('Inventory Report', 14, 20);
        doc.setFontSize(11);
        doc.text(`Report Period: ${days} days`, 14, 28);
        
        const data = getTableData();
        const tableData = data.map(item => [item.sku, item.price, item.quantity, item.businessPrice]);
        
        doc.autoTable({
            head: [['SKU', 'Price', 'Quantity', 'Business Price']],
            body: tableData,
            startY: 35
        });
        
        doc.save(`inventory_report_${days}days.pdf`);
    }
</script>
